## Relative Abundance

**User input in the BASH file**
```bash
# Relative Abundance arguments
METADATA_FILE="../input/george_data/hiv_dataset/hiv_meta.txt"
METADATA_SEP=" "
HEADER="n" # Does the metadata file contain a header before the entries start?
OVERWRITE="n" # Do you want to overwrite the files generated for each of your different experimental groups?
CELL_NAME_COL=1 # What column contains the cell names (first column = 0)
GROUP_INDICES=(2)

# Specify the control groups and experimental groups that you want to compare
    # 1st entry in control is compared to 1st entry in experimental, 2nd entry compared to 2nd entry, etc.
CONTROL_GROUPS=("Healthy")
EXPERIMENTAL_GROUPS=("HIV")
```

**Metadata File**

```
"0" "C1_Healthy_AAACGGGAGTCGTTTG.1" "Healthy"
"1" "C1_Healthy_AAACGGGTCAGGCGAA.1" "Healthy"
"2" "C1_Healthy_AAAGCAATCTCAACTT.1" "Healthy"
"3" "C1_Healthy_AACACGTAGAGCAATT.1" "Healthy"
"4" "C1_Healthy_AACCGCGCAATCCGAT.1" "Healthy"
```


**Argument Explanation:** 

Here, the dataset is being split based on the metadata file `hiv_meta.txt`. Columns in the file are separated with a space (`" "`), there is no header, and the names of the cells are in column 1 (indexing starts at 0). The group each cell belongs to is found in column 2, and the two groups of interest are "Healthy" and "HIV".

1) First, the columns in the dataset are split into the two groups "Healthy" and "HIV" and saved to separate csv files in the same location as the original data file. If you have already created the split group data files in the past and want to overwrite them, specify `OVERWRITE="y"` in the BASH file.

```
 ----------------------------------------------------------
|     RELATIVE ABUNDANCE FOR GEORGE_HIV HEALTHY VS HIV     |
 ----------------------------------------------------------

----- Splitting Data Files -----
        Group 1: Healthy
        Group 2: HIV

----- Saving Group Data Files -----
                Writing data to the group file...
                Writing data to the group file...
                Using existing group network hsa04370 file for Healthy
                Using existing group network hsa04370 file for HIV
                Control Group: Healthy
                Experimental Group: HIV
```

2) Next, the networks of interest are loaded for both groups

```
----- Loading george_hiv networks -----
        Loading CONTROL group networks
                Loaded network hsa04370_Healthy

        Loading EXPERIMENTAL group networks
                Loaded network hsa04370_HIV
```

3) Then, the relative abundance of each group is calculated along with a pathway modulation score. The pathway modulation score weighs the importance score and relative abundance of each node to determine if the pathway is significantly altered. It uses bootstrapping to determine if the pathway modulation score is significantly different compared to if the importance scores and relative abundances were randomly distributed among the genes.

> The distribution generated by bootstrapping can be viewed in the relative abundnace output folder

```
----- Calculating Relative Abundance between groups HIV and Healthy -----
        Network: hsa04370
                Pathway Modulation Score: 0.06087929272259514
                Calculating p-value with bootstrapping:
                        P-value: 0.5676
                        -log10(P-value): 0.2459576131380494
```